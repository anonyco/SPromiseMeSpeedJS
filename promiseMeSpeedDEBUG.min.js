(function(){function t(b){b()}function u(b){b(this)}function f(q){function p(g){d=null;m=g;e=!0;null!==c&&(c.forEach(u,g),c=null);null!==n&&(n.forEach(t),n=null);d=null}function a(g){c=null;m=g;e=!1;null!==d&&(d.forEach(u,g),d=null);null!==n&&(n.forEach(t),n=null);d=c=n=null}var m,e,c=null,d=null,n=null;if(h)k.push(q.bind(void 0,p,a)),++l;else if(++b,64<b&&(h=!0),q(p,a),--b,!b){for(q=0;q!==l;)k[q++]();k.length=l=0;h=!1}return{then:function(g,a){g&&"function"!==typeof g&&console.error(Object.prototype.toString.call(g)+
" is not valid function to be called after a successful promise");a&&"function"!==typeof a&&console.error(Object.prototype.toString.call(a)+" is not valid function to be called after a rejected promise");return f(function(b,f){g&&(null!==c?c.push(g):c=[g]);a&&(null!==d?d.push(a):d=[a]);void 0===e?(g&&c.push(function(){return b(g(_))}),a&&d.push(function(){return f(a(_))})):!0===e?g&&b(g(m)):a&&f(a(m))})},"catch":function(a){a&&"function"!==typeof a&&console.error(Object.prototype.toString.call(a)+
" is not valid function to be called after a rejected promise");a&&(null!==d?d.push(a):d=[a]);return f(function(b,c){void 0===e?a&&d.push(function(){return c(a(_))}):a&&c(a(m))})},"finally":function(a){"function"!==typeof a&&console.error(Object.prototype.toString.call(a)+" is not valid function to be called 'finally' after promise");void 0===e?n?n.push(a):n=[a]:a()}}}var k=[],v=window.Promise||Object.create(null);f.isPromise=function(b){return!!b&&(b.constructor===f||b.constructor===v)};var b=0,
h=!1,l=0;f.resolve=function a(p){var m={then:function(e){if(h)return f(function(a){k.push(function(){a(e(p))});++l});++b;64<b&&(h=!0);var c=e(p);--b;if(!b){for(var d=0;d!==l;)k[d++]();k.length=l=0;h=!1}return a(c)},"finally":function(a){if(h)k.push(a.bind(void 0,p));else if(++b,64<b&&(h=!0),a(p),--b,!b){for(a=0;a!==l;)k[a++]();k.length=l=0;h=!1}return m},"catch":function(){return m}};return m};f.reject=function m(a){var e={then:function(c){if(h)return f(function(b,d){k.push(function(){d(c(a))});++l});
++b;64<b&&(h=!0);var d=c(a);--b;if(!b){for(var e=0;e!==l;)k[e++]();k.length=l=0;h=!1}return m(d)},"finally":function(c){if(h)k.push(c.bind(void 0,a));else if(++b,64<b&&(h=!0),c(a),--b,!b){for(c=0;c!==l;)k[c++]();k.length=l=0;h=!1}return e},"catch":function(){return e}};return e};var r=!1;f.race=function(a){if(!a||!a.forEach||!Array.prototype.every.call(a,function(a){return f.a(a)}))return console.error(Object.prototype.toString.call(a)+" is not a valid iterable array of promises. If you are using an array-like object, then you must call Array.prototype.slice.call on the object before passing it to SPromise.race."),
f.resolve();r||a.length||(r=!0,console.warn(Object.prototype.toString.call(a)+" is an empty array of promises passed to SPromise"));return f(function(b){var e=!1;a.forEach(function(a){a.then(function(a){!1===e&&(e=!0,b(a),console.warn)})})})};f.all=function(a){if(!(a&&a.forEach&&a.every&&a.every(function(a){return f.a(a)})))return console.error(Object.prototype.toString.call(a)+" is not a valid iterable array of promises. If you are using an array-like object, then you must call Array.prototype.slice.call on the object before passing it to Promise.race."),
f.resolve();r||a.length||(r=!0,console.warn(Object.prototype.toString.call(a)+" is an empty array of promises passed to SPromise"));return f(function(b){var e=arr.length;a.forEach(function(a){a.then(function(a){--e||b(a)})})})};window.SPromise=f})();