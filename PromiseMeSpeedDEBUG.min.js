'use strict';(function(G){function B(g){g()}function C(g){g(this)}function E(){if(w){do t=!1,D.shift()();while(--w)}t=!1}function u(g){function l(b){0===d&&(q(b)?b.then(l,e):(a=b,d=2,null!==c&&("function"===typeof c?c(b):c.forEach(C,b),c=null),f=null,null!==m&&("function"===typeof m?m():m.forEach(B),m=null)))}function e(b){0===d&&(a=b,d=1,null!==f&&("function"===typeof f?f(b):f.forEach(C,b),f=null),c=null,null!==m&&("function"===typeof m?m():m.forEach(B),m=null))}var a,d=0,c=null,f=null,m=null,h=
{then:function(b,k){b&&"function"!==typeof b&&console.error(Object.prototype.toString.call(b)+" is not a valid function to be called after a successful promise");k&&"function"!==typeof k&&console.error(Object.prototype.toString.call(k)+" is not a valid function to be called after a rejected promise");if(0===d)return z(function(x){"function"===typeof b&&(null!==c?"function"===typeof c?c=[c,function(){x(b(a))}]:c.push(function(){x(b(a))}):c=function(){x(b(a))});"function"===typeof k&&(null!==f?"function"===
typeof f?f=[f,function(){x(k(a))}]:f.push(function(){x(k(a))}):f=function(){x(k(a))})});try{var n=null;2===d?"function"===typeof b&&(n=b(a)):"function"===typeof k&&(n=r(k(a)));return q(n)?n:A(n)}catch(x){return r(x)}},"catch":function(b){b&&"function"!==typeof b&&console.error(Object.prototype.toString.call(b)+" is not a valid function to be called after a rejected promise");if(0===d)return z(function(n){null!==f?"function"===typeof f?f=[f,function(){n(b(a))}]:f.push(function(){n(b(a))}):f=function(){n(b(a))};
null!==c?"function"===typeof c?c=[c,n]:c.push(n):c=n});if(2===d)return A(a);try{var k=b(a);return q(k)?k:A(k)}catch(n){return r(n)}},"finally":function(b){"function"!==typeof b&&console.error(Object.prototype.toString.call(b)+" is not a valid function to be called 'finally' after promise");if(0===d)null!==m?"function"===typeof m?m=[m,b]:m.push(b):m=b;else try{b()}catch(k){return r(k)}return h}};!1!==v&&(h[v]="Promise");if(t)D.push(function(){try{g(l,e)}catch(b){e(b)}}),w=w+1|0;else{p=p+1|0;if(128===
p){t=!0;try{g(l,e)}catch(b){e(b)}}else{try{g(l,e)}catch(b){e(b)}t&&1===p&&E()}p=p-1|0}return h}function z(g){function l(h){0===a&&(e=h,a=1,null!==c&&("function"===typeof c?c(h):c.forEach(C,h),c=null),d=null,null!==f&&("function"===typeof f?f():f.forEach(B),f=null))}var e,a=0,d=null,c=null,f=null,m={then:function(h,b){h&&"function"!==typeof h&&console.error(Object.prototype.toString.call(h)+" is not a valid function to be called after a successful promise");b&&"function"!==typeof b&&console.error(Object.prototype.toString.call(b)+
" is not a valid function to be called after a rejected promise");if(0===a)return u(function(n){"function"===typeof h&&(null!==d?"function"===typeof d?d=[d,function(){n(h(e))}]:d.push(function(){n(h(e))}):d=function(){n(h(e))});"function"===typeof b&&(null!==c?"function"===typeof c?c=[c,function(){n(b(e))}]:c.push(function(){n(b(e))}):c=function(){n(b(e))})});try{var k=null;2===a?"function"===typeof h&&(k=h(e)):"function"===typeof b&&(k=r(b(e)));return q(k)?k:y(k)}catch(n){return r(n)}},"catch":function(h){h&&
"function"!==typeof h&&console.error(Object.prototype.toString.call(h)+" is not a valid function to be called after a rejected promise");if(0===a)return u(function(k){null!==c?"function"===typeof c?c=[c,function(){k(h(e))}]:c.push(function(){k(h(e))}):c=function(){k(h(e))};null!==d?"function"===typeof d?d=[d,k]:d.push(k):d=k});if(2===a)return y(e);try{var b=h(e);return q(b)?b:y(b)}catch(k){return r(k)}},"finally":function(h){"function"!==typeof h&&console.error(Object.prototype.toString.call(h)+" is not a valid function to be called 'finally' after promise");
0===a?null!==f?"function"===typeof f?f=[f,h]:f.push(h):f=h:h();return m}};!1!==v&&(m[v]="Promise");try{g(function(h){0===a&&(q(h)?h.then(acceptP,l):(e=h,a=2,null!==d&&("function"===typeof d?d(h):d.forEach(C,h),d=null),c=null,null!==f&&("function"===typeof f?f():f.forEach(B),f=null)))},l)}catch(h){l(h)}return m}function y(g){if(q(g))return z(function(e,a){g.then(e,a)});var l={then:function(e){if(t)return z(function(d,c){D.push(function(){try{var f=e(g);q(f)?f.then(d,c):d(f)}catch(m){c(m)}});w=w+1|
0});p=p+1|0;var a=null;try{128===p?(t=!0,a=e(g)):(a=e(g),t&&1===p&&E())}catch(d){return r(d)}finally{p=p-1|0}return q(a)?a:A(a)},"catch":function(){return l},"finally":function(e){if(t)D.push(e),w=w+1|0;else{p=p+1|0;try{128===p?(t=!0,e(),t=!1):(e(),t&&1===p&&E())}catch(a){return r(a)}finally{p=p-1|0}}return l}};!1!==v&&(l[v]="Promise");return l}function A(g){if(q(g))return z(function(e,a){g.then(e,a)});var l={then:function(e){try{var a=e(g);return q(a)?a:y(a)}catch(d){return r(d)}},"finally":function(e){try{e()}catch(a){return r(a)}return l},
"catch":function(){return l}};!1!==v&&(l[v]="Promise");return l}function r(g){var l={then:function(e,a){try{var d="function"===typeof a?a(g):l;return q(d)?d:y(d)}catch(c){return r(c)}},"finally":function(e){try{e()}catch(a){return r(a)}return l},"catch":function(e){try{var a=e(g);return q(a)?a:y(a)}catch(d){return r(d)}}};!1!==v&&(l[v]="Promise");return l}const D=[],q=u.isPromise=function(g){return"object"===typeof g&&null!==g&&"function"===typeof g.then};var p=0,t=!1,w=0,v="undefined"!==typeof Symbol&&
Symbol.toStringTag;u.resolve=A;u.reject=r;var F=!1;u.race=function(g){if(!g||!g.forEach)return console.error(Object.prototype.toString.call(g)+" is not a valid iterable array of promises. If you are using an array-like object, then you must call Array.prototype.slice.call on the object before passing it to SPromise.race."),y();F||g.length||(F=!0,console.warn(Object.prototype.toString.call(g)+" is an empty array of promises passed to SPromise"));return u(function(l,e){for(var a=!1,d=0;d<g.length;d=
d+1|0){var c=g[d];if(q(c)){if(c.then(function(f){!1===a&&(a=!0,l(f))},function(f){!1===a&&(a=!0,e(f))}),a)break}else{a=!0;l(c);break}}})};u.all=function(g){return g&&g.forEach?u(function(l,e){for(var a=0,d=[],c=0;c<g.length;c=c+1|0){var f=g[c];q(f)?(a=a+1|0,f.then(function(m){d[c]=m;a=a-1|0;0===a&&l(d)},function(m){0<a&&(a=-1,e(m))})):d[c]=f}a||l(d)}):(console.error(Object.prototype.toString.call(g)+" is not a valid iterable array of promises. If you are using an array-like object, then you must call Array.prototype.slice.call on the object before passing it to SPromise.all."),
y())};G.SPromise=u})("undefined"===typeof self?this:self);
