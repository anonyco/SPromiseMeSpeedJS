(function(){function r(a){a()}function t(a){a(this)}function k(q){function p(f){e=null;m=f;b=!0;null!==d&&(d.forEach(t,f),d=null);null!==g&&(g.forEach(r),g=null);e=null}function n(f){d=null;m=f;b=!1;null!==e&&(e.forEach(t,f),e=null);null!==g&&(g.forEach(r),g=null);e=d=g=null}var m,b,d=null,e=null,g=null;if(c)h.push(q.bind(void 0,p,n)),++l;else if(++a,64<a&&(c=!0),q(p,n),--a,!a){for(q=0;q!==l;)h[q++]();h.length=l=0;c=!1}return{then:function(f,a){return k(function(g,c){f&&(null!==d?d.push(f):d=[f]);
a&&(null!==e?e.push(a):e=[a]);void 0===b?(f&&d.push(function(){return g(f(_))}),a&&e.push(function(){return c(a(_))})):!0===b?f&&g(f(m)):a&&c(a(m))})},"catch":function(a){a&&(null!==e?e.push(a):e=[a]);return k(function(d,f){void 0===b?a&&e.push(function(){return f(a(_))}):a&&f(a(m))})},"finally":function(a){void 0===b?g?g.push(a):g=[a]:a()}}}var h=[],u=window.Promise||Object.create(null);k.isPromise=function(a){return!!a&&(a.constructor===k||a.constructor===u)};var a=0,c=!1,l=0;k.resolve=function n(p){var m=
{then:function(b){if(c)return k(function(a){h.push(function(){a(b(p))});++l});++a;64<a&&(c=!0);var d=b(p);--a;if(!a){for(var e=0;e!==l;)h[e++]();h.length=l=0;c=!1}return n(d)},"finally":function(b){if(c)h.push(b.bind(void 0,p));else if(++a,64<a&&(c=!0),b(p),--a,!a){for(b=0;b!==l;)h[b++]();h.length=l=0;c=!1}return m},"catch":function(){return m}};return m};k.reject=function m(n){var b={then:function(d){if(c)return k(function(a,b){h.push(function(){b(d(n))});++l});++a;64<a&&(c=!0);var b=d(n);--a;if(!a){for(var g=
0;g!==l;)h[g++]();h.length=l=0;c=!1}return m(b)},"finally":function(d){if(c)h.push(d.bind(void 0,n));else if(++a,64<a&&(c=!0),d(n),--a,!a){for(d=0;d!==l;)h[d++]();h.length=l=0;c=!1}return b},"catch":function(){return b}};return b};k.race=function(a){return k(function(c){var b=!1;a.forEach(function(a){a.then(function(a){!1===b&&(b=!0,c(a),console.warn)})})})};k.all=function(a){return k(function(c){var b=arr.length;a.forEach(function(a){a.then(function(a){--b||c(a)})})})};window.SPromise=k})();